{"ast":null,"code":"import React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nconst Profile = () => {\n  /*\r\n  const id_cliente =  localStorage.getItem(\"id_usuario\");\r\n  console.log(\"id:\",id_cliente);\r\n  const [usuario, setUsuario] = useState(null);\r\n  const [direcciones, setDirecciones] = useState([]);\r\n  const [mostrarDirecciones, setMostrarDirecciones] = useState(false);\r\n  const [mostrarAgregar, setMostrarAgregar] = useState(false);\r\n    const [paises, setPaises] = useState([]);\r\n  const [ciudades, setCiudades] = useState([]);\r\n    const [form, setForm] = useState({\r\n    distrito: \"\",\r\n    calle: \"\",\r\n    referencia: \"\",\r\n    codigo_postal: \"\",\r\n    id_pais: \"\",\r\n    id_ciudad: \"\"\r\n  });\r\n   \r\n  useEffect(() => {\r\n    fetch(`http://localhost:3001/profile?id_cliente=${id_cliente}`)\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        setUsuario(data);\r\n      });\r\n  }, []);\r\n  \r\n  const cargarDirecciones = () => {\r\n    fetch(`http://localhost:3001/direccion?id_cliente=${id_cliente}`)\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        console.log(\"DIRECCIONES RECIBIDAS:\", data); //\r\n        setDirecciones(data);\r\n        setMostrarDirecciones(true);\r\n      });\r\n  };\r\n    const cargarPaises = () => {\r\n    fetch(\"http://localhost:3001/paises\")\r\n      .then((res) => res.json())\r\n      .then((data) => setPaises(data));\r\n  };\r\n    const cargarCiudades = (id_pais) => {\r\n    fetch(`http://localhost:3001/ciudades?id_pais=${id_pais}`)\r\n      .then((res) => res.json())\r\n      .then((data) => setCiudades(data));\r\n  };\r\n    const cambiarValor = (e) => {\r\n    setForm({ ...form, [e.target.name]: e.target.value });\r\n  \r\n    if (e.target.name === \"id_pais\") {\r\n      cargarCiudades(e.target.value);\r\n    }\r\n  };\r\n    const agregarDireccion = (e) => {\r\n    e.preventDefault();\r\n      const body = {\r\n      ...form,\r\n      id_cliente\r\n    };\r\n      fetch(\"http://localhost:3001/direccionAgregar\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify(body)\r\n    })\r\n      .then((res) => res.json())\r\n      .then(() => {\r\n        alert(\"Dirección agregada correctamente!\");\r\n        setMostrarAgregar(false);\r\n        cargarDirecciones(); \r\n      });\r\n  };\r\n    if (!usuario) return <p>Cargando perfil...</p>;\r\n    return (\r\n    <div style={{ padding: \"20px\" }}>\r\n      <h2>Perfil del Usuario</h2>\r\n        <p><strong>Nombre:</strong> {usuario.nombre}</p>\r\n      <p><strong>Apellido paterno:</strong> {usuario.apellido_paterno} </p>\r\n      <p><strong>Apellido materno:</strong> {usuario.apellido_materno}</p>\r\n      <p><strong>Correo:</strong> {usuario.correo_electronico}</p>\r\n      <p><strong>Teléfono:</strong> {usuario.telefono}</p>\r\n      <p><strong>DNI:</strong> {usuario.dni}</p>\r\n      <p><strong>Saldo:</strong> {usuario.saldo}</p>\r\n        <hr />\r\n        <button onClick={cargarDirecciones}>Ver direcciones</button>\r\n        <button onClick={() => { setMostrarAgregar(true); cargarPaises(); }}>\r\n        Agregar dirección\r\n      </button>\r\n      \r\n      <button onClick={() => navigate(\"/deudas\")}>\r\n          Ver deudas\r\n        </button>\r\n  \r\n      {mostrarDirecciones && (\r\n        <div style={{ marginTop: \"20px\" }}>\r\n          <h3>Mis direcciones</h3>\r\n            {direcciones.length === 0 ? (\r\n            <p>No tienes direcciones registradas</p>\r\n          ) : (\r\n            <ul>\r\n              {direcciones.map((d, i) => (\r\n                <li key={i}>\r\n                  <strong>{d.calle}</strong> - {d.distrito}, {d.ciudad} ({d.nombre})\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          )}\r\n        </div>\r\n      )}\r\n        {mostrarAgregar && (\r\n        <div style={{ marginTop: \"20px\" }}>\r\n          <h3>Agregar nueva dirección</h3>\r\n            <form onSubmit={agregarDireccion}>\r\n            <input\r\n              type=\"text\"\r\n              name=\"distrito\"\r\n              placeholder=\"Distrito\"\r\n              value={form.distrito}\r\n              onChange={cambiarValor}\r\n              required\r\n            /><br/>\r\n              <input\r\n              type=\"text\"\r\n              name=\"calle\"\r\n              placeholder=\"Calle\"\r\n              value={form.calle}\r\n              onChange={cambiarValor}\r\n              required\r\n            /><br/>\r\n              <input\r\n              type=\"text\"\r\n              name=\"referencia\"\r\n              placeholder=\"Referencia\"\r\n              value={form.referencia}\r\n              onChange={cambiarValor}\r\n              required\r\n            /><br/>\r\n              <input\r\n              type=\"text\"\r\n              name=\"codigo_postal\"\r\n              placeholder=\"Código Postal\"\r\n              value={form.codigo_postal}\r\n              onChange={cambiarValor}\r\n              required\r\n            /><br/>\r\n  \r\n            <select name=\"id_pais\" value={form.id_pais} onChange={cambiarValor} required>\r\n              <option value=\"\">Seleccione un país</option>\r\n              {paises.map((p) => (\r\n                <option key={p.id_pais} value={p.id_pais}>\r\n                  {p.nombre}\r\n                </option>\r\n              ))}\r\n            </select><br/>\r\n  \r\n            <select name=\"id_ciudad\" value={form.id_ciudad} onChange={cambiarValor} required>\r\n              <option value=\"\">Seleccione una ciudad</option>\r\n              {ciudades.map((c) => (\r\n                <option key={c.id_ciudad} value={c.id_ciudad}>\r\n                  {c.nombre}\r\n                </option>\r\n              ))}\r\n            </select><br/>\r\n              <button type=\"submit\">Guardar</button>\r\n          </form>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );*/\n};\n_c = Profile;\nexport default Profile;\nvar _c;\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"names":["React","useEffect","useState","useNavigate","Profile","_c","$RefreshReg$"],"sources":["C:/Users/lolitascim/bd/bichomania-app/ayuda/src/perfil_usuario/Perfil.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst Profile = () => {\r\n  /*\r\n  const id_cliente =  localStorage.getItem(\"id_usuario\");\r\n  console.log(\"id:\",id_cliente);\r\n  const [usuario, setUsuario] = useState(null);\r\n  const [direcciones, setDirecciones] = useState([]);\r\n  const [mostrarDirecciones, setMostrarDirecciones] = useState(false);\r\n  const [mostrarAgregar, setMostrarAgregar] = useState(false);\r\n\r\n  const [paises, setPaises] = useState([]);\r\n  const [ciudades, setCiudades] = useState([]);\r\n\r\n  const [form, setForm] = useState({\r\n    distrito: \"\",\r\n    calle: \"\",\r\n    referencia: \"\",\r\n    codigo_postal: \"\",\r\n    id_pais: \"\",\r\n    id_ciudad: \"\"\r\n  });\r\n\r\n \r\n  useEffect(() => {\r\n    fetch(`http://localhost:3001/profile?id_cliente=${id_cliente}`)\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        setUsuario(data);\r\n      });\r\n  }, []);\r\n\r\n\r\n  const cargarDirecciones = () => {\r\n    fetch(`http://localhost:3001/direccion?id_cliente=${id_cliente}`)\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        console.log(\"DIRECCIONES RECIBIDAS:\", data); //\r\n        setDirecciones(data);\r\n        setMostrarDirecciones(true);\r\n      });\r\n  };\r\n\r\n  const cargarPaises = () => {\r\n    fetch(\"http://localhost:3001/paises\")\r\n      .then((res) => res.json())\r\n      .then((data) => setPaises(data));\r\n  };\r\n\r\n  const cargarCiudades = (id_pais) => {\r\n    fetch(`http://localhost:3001/ciudades?id_pais=${id_pais}`)\r\n      .then((res) => res.json())\r\n      .then((data) => setCiudades(data));\r\n  };\r\n\r\n  const cambiarValor = (e) => {\r\n    setForm({ ...form, [e.target.name]: e.target.value });\r\n\r\n\r\n    if (e.target.name === \"id_pais\") {\r\n      cargarCiudades(e.target.value);\r\n    }\r\n  };\r\n\r\n  const agregarDireccion = (e) => {\r\n    e.preventDefault();\r\n\r\n    const body = {\r\n      ...form,\r\n      id_cliente\r\n    };\r\n\r\n    fetch(\"http://localhost:3001/direccionAgregar\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify(body)\r\n    })\r\n      .then((res) => res.json())\r\n      .then(() => {\r\n        alert(\"Dirección agregada correctamente!\");\r\n        setMostrarAgregar(false);\r\n        cargarDirecciones(); \r\n      });\r\n  };\r\n\r\n  if (!usuario) return <p>Cargando perfil...</p>;\r\n\r\n  return (\r\n    <div style={{ padding: \"20px\" }}>\r\n      <h2>Perfil del Usuario</h2>\r\n\r\n      <p><strong>Nombre:</strong> {usuario.nombre}</p>\r\n      <p><strong>Apellido paterno:</strong> {usuario.apellido_paterno} </p>\r\n      <p><strong>Apellido materno:</strong> {usuario.apellido_materno}</p>\r\n      <p><strong>Correo:</strong> {usuario.correo_electronico}</p>\r\n      <p><strong>Teléfono:</strong> {usuario.telefono}</p>\r\n      <p><strong>DNI:</strong> {usuario.dni}</p>\r\n      <p><strong>Saldo:</strong> {usuario.saldo}</p>\r\n\r\n      <hr />\r\n\r\n      <button onClick={cargarDirecciones}>Ver direcciones</button>\r\n\r\n      <button onClick={() => { setMostrarAgregar(true); cargarPaises(); }}>\r\n        Agregar dirección\r\n      </button>\r\n      \r\n      <button onClick={() => navigate(\"/deudas\")}>\r\n          Ver deudas\r\n        </button>\r\n\r\n\r\n      {mostrarDirecciones && (\r\n        <div style={{ marginTop: \"20px\" }}>\r\n          <h3>Mis direcciones</h3>\r\n\r\n          {direcciones.length === 0 ? (\r\n            <p>No tienes direcciones registradas</p>\r\n          ) : (\r\n            <ul>\r\n              {direcciones.map((d, i) => (\r\n                <li key={i}>\r\n                  <strong>{d.calle}</strong> - {d.distrito}, {d.ciudad} ({d.nombre})\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {mostrarAgregar && (\r\n        <div style={{ marginTop: \"20px\" }}>\r\n          <h3>Agregar nueva dirección</h3>\r\n\r\n          <form onSubmit={agregarDireccion}>\r\n            <input\r\n              type=\"text\"\r\n              name=\"distrito\"\r\n              placeholder=\"Distrito\"\r\n              value={form.distrito}\r\n              onChange={cambiarValor}\r\n              required\r\n            /><br/>\r\n\r\n            <input\r\n              type=\"text\"\r\n              name=\"calle\"\r\n              placeholder=\"Calle\"\r\n              value={form.calle}\r\n              onChange={cambiarValor}\r\n              required\r\n            /><br/>\r\n\r\n            <input\r\n              type=\"text\"\r\n              name=\"referencia\"\r\n              placeholder=\"Referencia\"\r\n              value={form.referencia}\r\n              onChange={cambiarValor}\r\n              required\r\n            /><br/>\r\n\r\n            <input\r\n              type=\"text\"\r\n              name=\"codigo_postal\"\r\n              placeholder=\"Código Postal\"\r\n              value={form.codigo_postal}\r\n              onChange={cambiarValor}\r\n              required\r\n            /><br/>\r\n\r\n\r\n            <select name=\"id_pais\" value={form.id_pais} onChange={cambiarValor} required>\r\n              <option value=\"\">Seleccione un país</option>\r\n              {paises.map((p) => (\r\n                <option key={p.id_pais} value={p.id_pais}>\r\n                  {p.nombre}\r\n                </option>\r\n              ))}\r\n            </select><br/>\r\n\r\n\r\n            <select name=\"id_ciudad\" value={form.id_ciudad} onChange={cambiarValor} required>\r\n              <option value=\"\">Seleccione una ciudad</option>\r\n              {ciudades.map((c) => (\r\n                <option key={c.id_ciudad} value={c.id_ciudad}>\r\n                  {c.nombre}\r\n                </option>\r\n              ))}\r\n            </select><br/>\r\n\r\n            <button type=\"submit\">Guardar</button>\r\n          </form>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );*/\r\n};\r\n\r\nexport default Profile;\r\n"],"mappings":"AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,WAAW,QAAQ,kBAAkB;AAE9C,MAAMC,OAAO,GAAGA,CAAA,KAAM;EACpB;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtKE,CAkMD;AAACC,EAAA,GAnMID,OAAO;AAqMb,eAAeA,OAAO;AAAC,IAAAC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}